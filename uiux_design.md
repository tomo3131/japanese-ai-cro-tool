# UI/UX設計書

## 3. UI/UX設計

### 3.1 画面一覧

#### 認証前

| 画面ID | 画面名 | URL | 説明 |
|--------|--------|-----|------|
| AUTH-01 | ランディングページ | `/` | サービス紹介、価格表示 |
| AUTH-02 | ログイン | `/login` | メール/パスワードログイン、OAuth |
| AUTH-03 | サインアップ | `/signup` | 新規登録、無料トライアル開始 |
| AUTH-04 | パスワードリセット | `/reset-password` | パスワード再設定 |

#### ダッシュボード

| 画面ID | 画面名 | URL | 説明 |
|--------|--------|-----|------|
| DASH-01 | ホームダッシュボード | `/dashboard` | KPI概要、最近のアクティビティ |
| DASH-02 | サイト選択 | `/dashboard/sites` | 複数サイト管理 |

#### パーソナライゼーション（凛 - RIN）

| 画面ID | 画面名 | URL | 説明 |
|--------|--------|-----|------|
| PERS-01 | ルール一覧 | `/personalization/rules` | パーソナライゼーションルール管理 |
| PERS-02 | ルール作成 | `/personalization/rules/new` | 新規ルール作成 |
| PERS-03 | ルール編集 | `/personalization/rules/:id/edit` | 既存ルール編集 |
| PERS-04 | ビジュアルエディタ | `/personalization/editor` | WYSIWYG編集 |
| PERS-05 | セグメント管理 | `/personalization/segments` | セグメント定義 |
| PERS-06 | パフォーマンス | `/personalization/performance` | ルール別効果測定 |

#### A/Bテスト（匠 - TAKUMI）

| 画面ID | 画面名 | URL | 説明 |
|--------|--------|-----|------|
| TEST-01 | 実験一覧 | `/experiments` | 進行中・完了した実験 |
| TEST-02 | 実験作成 | `/experiments/new` | 新規実験セットアップ |
| TEST-03 | 実験詳細 | `/experiments/:id` | 結果、統計分析 |
| TEST-04 | バリアント編集 | `/experiments/:id/variants` | テストパターン編集 |
| TEST-05 | AI仮説生成 | `/experiments/ai-hypothesis` | AIによる仮説提案 |
| TEST-06 | 統計分析 | `/experiments/:id/analysis` | 有意差判定、信頼区間 |

#### パフォーマンス監視（守 - MAMORU）

| 画面ID | 画面名 | URL | 説明 |
|--------|--------|-----|------|
| PERF-01 | Core Web Vitals | `/performance/vitals` | LCP、FID、CLS監視 |
| PERF-02 | ページ速度 | `/performance/speed` | ページ別速度分析 |
| PERF-03 | エラーログ | `/performance/errors` | JavaScript エラー |
| PERF-04 | アラート設定 | `/performance/alerts` | しきい値設定 |

#### 設定

| 画面ID | 画面名 | URL | 説明 |
|--------|--------|-----|------|
| SET-01 | サイト設定 | `/settings/site` | ドメイン、トラッキングコード |
| SET-02 | 広告連携 | `/settings/integrations` | Google Ads、Meta連携 |
| SET-03 | チーム管理 | `/settings/team` | メンバー招待、権限管理 |
| SET-04 | プラン・請求 | `/settings/billing` | プラン変更、請求履歴 |
| SET-05 | API設定 | `/settings/api` | APIキー管理 |

#### オンボーディング

| 画面ID | 画面名 | URL | 説明 |
|--------|--------|-----|------|
| ONB-01 | ウェルカム | `/onboarding/welcome` | サービス概要説明 |
| ONB-02 | サイト登録 | `/onboarding/site-setup` | 初回サイト登録 |
| ONB-03 | トラッキング設置 | `/onboarding/tracking` | SDKインストール |
| ONB-04 | 初回ルール作成 | `/onboarding/first-rule` | ガイド付きルール作成 |
| ONB-05 | 完了 | `/onboarding/complete` | 次のステップ案内 |

**合計**: 35画面

---

### 3.2 ユーザーフロー

#### フロー1: 新規ユーザー登録〜初回ルール作成

```
[ランディングページ] 
    ↓ 「無料トライアル開始」クリック
[サインアップ]
    ↓ メールアドレス、パスワード入力
[メール認証]
    ↓ 認証リンククリック
[ウェルカム画面]
    ↓ 「始める」クリック
[サイト登録]
    ↓ ドメイン、サイト名入力
[トラッキング設置]
    ↓ SDKコードをコピー、サイトに設置
    ↓ 「設置完了、確認」クリック
[トラッキング検証中...]
    ↓ 検証成功
[初回ルール作成ガイド]
    ↓ 「広告経由の訪問者に特別オファーを表示」選択
[ビジュアルエディタ]
    ↓ コンテンツ編集
[プレビュー]
    ↓ 「公開」クリック
[完了画面]
    ↓ 「ダッシュボードへ」
[ホームダッシュボード]
```

**所要時間目標**: 15分以内

#### フロー2: A/Bテスト作成〜結果確認

```
[実験一覧]
    ↓ 「新規実験作成」クリック
[実験セットアップ]
    ↓ 実験名、仮説、対象URL入力
    ↓ 「AI仮説生成」クリック（オプション）
[AI仮説提案]
    ↓ 提案を選択または独自入力
[バリアント設定]
    ↓ バリアントA（コントロール）確認
    ↓ バリアントB作成（ビジュアルエディタ）
[トラフィック設定]
    ↓ 配分率設定（50/50など）
    ↓ 参加率設定（100%など）
[プレビュー]
    ↓ 両バリアントを確認
[実験開始]
    ↓ 「実験を開始」クリック
[実験詳細（進行中）]
    ↓ リアルタイムで結果確認
    ↓ 統計的有意差に達したら通知
[統計分析]
    ↓ 勝者バリアント確認
    ↓ 「勝者を適用」クリック
[実験完了]
```

**所要時間目標**: 
- 実験作成: 10分
- 実験期間: 7-14日（推奨）
- 結果確認: 5分

#### フロー3: パーソナライゼーションルール作成

```
[ルール一覧]
    ↓ 「新規ルール作成」クリック
[ルールテンプレート選択]
    ↓ 「広告経由」「リピーター」「地域別」などから選択
[セグメント設定]
    ↓ 条件を追加（UTMパラメータ、訪問回数、地域など）
[対象URL設定]
    ↓ URLパターン入力（例: /lp/*）
[コンテンツ編集]
    ↓ ビジュアルエディタで変更箇所を指定
    ↓ テキスト、画像、CTA変更
[日本語最適化（オプション）]
    ↓ 敬語レベル選択
    ↓ 商習慣対応（税込表示など）
[プレビュー]
    ↓ セグメント別にプレビュー
[公開]
    ↓ 「公開」クリック
[ルール一覧]
    ↓ パフォーマンス監視
```

**所要時間目標**: 8分以内

---

### 3.3 ワイヤーフレーム

#### DASH-01: ホームダッシュボード

```
┌─────────────────────────────────────────────────────────────┐
│ [Logo] Fibr JP        [サイト選択▼]  [通知🔔] [アバター▼]   │
├─────────────────────────────────────────────────────────────┤
│ サイドバー              │  メインコンテンツ                    │
│                        │                                      │
│ 📊 ダッシュボード ●    │  ┌─────────────────────────────┐  │
│ 🎨 パーソナライゼーション│  │ 今月のパフォーマンス           │  │
│ 🧪 A/Bテスト           │  │                                │  │
│ 📈 パフォーマンス       │  │  CVR改善率    +23.5% ↑        │  │
│ ⚙️  設定               │  │  実行中のテスト  5件           │  │
│                        │  │  アクティブルール 12件          │  │
│ ───────────────        │  └─────────────────────────────┘  │
│                        │                                      │
│ 🤖 AIエージェント      │  ┌─────────────────────────────┐  │
│                        │  │ 凛（RIN）からの提案            │  │
│ 凛 パーソナライゼーション│  │                                │  │
│ 匠 実験                │  │ 💡 「商品ページの離脱率が高い  │  │
│ 守 監視                │  │    です。価格表示の最適化を    │  │
│                        │  │    試してみませんか？」         │  │
│                        │  │                                │  │
│                        │  │  [詳細を見る] [ルール作成]     │  │
│                        │  └─────────────────────────────┘  │
│                        │                                      │
│                        │  ┌─────────────────────────────┐  │
│                        │  │ 最近のアクティビティ           │  │
│                        │  │                                │  │
│                        │  │ ⚡ 実験「CTAボタン色」が統計的 │  │
│                        │  │    有意差に達しました（2時間前）│  │
│                        │  │                                │  │
│                        │  │ ✅ ルール「リピーター向け特典」│  │
│                        │  │    を公開しました（5時間前）    │  │
│                        │  │                                │  │
│                        │  │ 📊 CVRが前週比+15%改善（昨日） │  │
│                        │  └─────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

#### TEST-02: 実験作成

```
┌─────────────────────────────────────────────────────────────┐
│ ← 実験一覧に戻る                                             │
├─────────────────────────────────────────────────────────────┤
│                   新規A/Bテスト作成                          │
│                                                              │
│  ステップ 1/5: 基本設定                                      │
│  ●━━○━━○━━○━━○                                          │
│                                                              │
│  実験名 *                                                    │
│  ┌──────────────────────────────────────────┐             │
│  │ CTAボタンの色テスト                        │             │
│  └──────────────────────────────────────────┘             │
│                                                              │
│  仮説 *                                                      │
│  ┌──────────────────────────────────────────┐             │
│  │ 緑色のCTAボタンは青色よりもクリック率が    │  [AI提案💡]  │
│  │ 高いと予想される                           │             │
│  └──────────────────────────────────────────┘             │
│                                                              │
│  対象URL *                                                   │
│  ┌──────────────────────────────────────────┐             │
│  │ https://example.com/lp/campaign          │             │
│  └──────────────────────────────────────────┘             │
│                                                              │
│  テストタイプ                                                │
│  ◉ A/Bテスト（2パターン）                                   │
│  ○ 多変量テスト（複数要素）                                 │
│  ○ リダイレクトテスト（別URL）                              │
│                                                              │
│                                    [キャンセル] [次へ →]    │
└─────────────────────────────────────────────────────────────┘
```

#### PERS-04: ビジュアルエディタ

```
┌─────────────────────────────────────────────────────────────┐
│ ビジュアルエディタ                        [プレビュー] [保存] │
├─────────────────────────────────────────────────────────────┤
│ 左パネル（ツール）     │  中央（プレビュー）   │ 右パネル（設定）│
│                        │                      │                │
│ 🖱️  選択               │  ┌────────────────┐ │ 選択中の要素   │
│ 📝 テキスト編集        │  │ [Hero Image]   │ │                │
│ 🖼️  画像変更           │  │                │ │ タイプ: 画像   │
│ 🎨 スタイル変更        │  │  特別キャンペーン │ │                │
│ ➕ 要素追加            │  │  実施中！       │ │ 画像URL        │
│ 🗑️  削除               │  │                │ │ ┌────────────┐│
│                        │  │  [今すぐ申込]  │ │ │/img/hero.jpg││
│ ───────────────        │  │      ↑選択中   │ │ └────────────┘│
│                        │  └────────────────┘ │ [変更]         │
│ 🌐 日本語最適化        │                      │                │
│                        │                      │ 代替テキスト   │
│ 敬語レベル             │                      │ ┌────────────┐│
│ ○ 丁寧語（です・ます） │                      │ │キャンペーン画像││
│ ○ 尊敬語              │                      │ └────────────┘│
│ ◉ カジュアル           │                      │                │
│                        │                      │ サイズ         │
│ 商習慣対応             │                      │ 幅: 100%       │
│ ☑ 税込価格表示         │                      │ 高さ: auto     │
│ ☑ 送料無料強調         │                      │                │
│                        │                      │ [削除]         │
└─────────────────────────────────────────────────────────────┘
```

#### TEST-03: 実験詳細（結果）

```
┌─────────────────────────────────────────────────────────────┐
│ ← 実験一覧に戻る                                             │
├─────────────────────────────────────────────────────────────┤
│ CTAボタンの色テスト                          [⏸️ 一時停止]   │
│ ステータス: 🟢 実行中  |  開始: 2025/10/13  |  経過: 7日     │
│                                                              │
│ ┌────────────────────────────────────────────────────────┐ │
│ │ 📊 結果サマリー                                          │ │
│ │                                                          │ │
│ │  バリアントA（青）    バリアントB（緑）   改善率         │ │
│ │  ──────────────────────────────────────────────────    │ │
│ │  訪問者数    5,234        5,198         -0.7%          │ │
│ │  コンバージョン 287          342        +19.2% ↑       │ │
│ │  CVR         5.48%        6.58%        +20.1% ↑       │ │
│ │                                                          │ │
│ │  統計的有意性: ✅ 達成（信頼度 95%）                     │ │
│ │  推奨アクション: バリアントBを適用                       │ │
│ │                                                          │ │
│ │                              [勝者を適用] [レポート出力] │ │
│ └────────────────────────────────────────────────────────┘ │
│                                                              │
│ ┌────────────────────────────────────────────────────────┐ │
│ │ 📈 時系列グラフ                                          │ │
│ │                                                          │ │
│ │  CVR                                                     │ │
│ │  8% ┤                              ╭─ バリアントB       │ │
│ │  6% ┤                    ╭────────╯                     │ │
│ │  4% ┤          ╭────────╯ バリアントA                   │ │
│ │  2% ┤    ╭────╯                                         │ │
│ │  0% └────┴────┴────┴────┴────┴────┴────                │ │
│ │     10/13  10/15  10/17  10/19  10/21  10/23           │ │
│ └────────────────────────────────────────────────────────┘ │
│                                                              │
│ ┌────────────────────────────────────────────────────────┐ │
│ │ 🔬 統計分析                                              │ │
│ │                                                          │ │
│ │  信頼区間（95%）                                         │ │
│ │  バリアントA: 5.1% - 5.9%                               │ │
│ │  バリアントB: 6.1% - 7.1%                               │ │
│ │                                                          │ │
│ │  P値: 0.003 (< 0.05)                                    │ │
│ │  検出力: 89%                                             │ │
│ │                                                          │ │
│ │  💡 AIインサイト:                                        │ │
│ │  「緑色のCTAボタンは統計的に有意にCVRを改善しています。  │ │
│ │   モバイルユーザーで特に効果が高い（+28%）ことが        │ │
│ │   わかりました。」                                       │ │
│ └────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

---

### 3.4 デザインシステム

#### カラーパレット

**プライマリーカラー**:
- Primary: `#3B82F6` (青) - CTA、リンク
- Primary Dark: `#1E40AF`
- Primary Light: `#DBEAFE`

**セカンダリーカラー**:
- Success: `#10B981` (緑) - 成功、改善
- Warning: `#F59E0B` (オレンジ) - 警告
- Error: `#EF4444` (赤) - エラー、悪化
- Info: `#6366F1` (紫) - 情報

**ニュートラル**:
- Gray 50: `#F9FAFB` (背景)
- Gray 100: `#F3F4F6` (カード背景)
- Gray 200: `#E5E7EB` (ボーダー)
- Gray 600: `#4B5563` (本文)
- Gray 900: `#111827` (見出し)

**AIエージェントカラー**:
- 凛（RIN）: `#EC4899` (ピンク) - パーソナライゼーション
- 匠（TAKUMI）: `#8B5CF6` (紫) - 実験
- 守（MAMORU）: `#14B8A6` (ティール) - 監視

#### タイポグラフィ

**フォントファミリー**:
```css
font-family: 
  'Noto Sans JP',        /* 日本語 */
  -apple-system, 
  BlinkMacSystemFont, 
  'Segoe UI', 
  'Roboto', 
  sans-serif;
```

**フォントサイズ**:
- H1: 32px / 2rem (ページタイトル)
- H2: 24px / 1.5rem (セクション見出し)
- H3: 20px / 1.25rem (サブ見出し)
- Body: 16px / 1rem (本文)
- Small: 14px / 0.875rem (補足)
- XSmall: 12px / 0.75rem (ラベル)

**フォントウェイト**:
- Regular: 400 (本文)
- Medium: 500 (強調)
- Bold: 700 (見出し)

#### スペーシング

**8pxグリッドシステム**:
- xs: 4px
- sm: 8px
- md: 16px
- lg: 24px
- xl: 32px
- 2xl: 48px
- 3xl: 64px

#### コンポーネント

**ボタン**:
```
プライマリー: 青背景、白文字、角丸8px、高さ40px
セカンダリー: 白背景、青文字、青ボーダー
テキスト: 背景なし、青文字、下線なし

サイズ:
- Small: 高さ32px、パディング 8px 16px
- Medium: 高さ40px、パディング 12px 24px
- Large: 高さ48px、パディング 16px 32px
```

**カード**:
```
背景: 白
ボーダー: 1px solid Gray 200
角丸: 12px
シャドウ: 0 1px 3px rgba(0,0,0,0.1)
パディング: 24px
```

**入力フィールド**:
```
背景: 白
ボーダー: 1px solid Gray 300
角丸: 8px
高さ: 40px
パディング: 8px 12px
フォーカス: ボーダー Primary、シャドウ
```

**通知バナー**:
```
Success: 緑背景、緑アイコン
Warning: オレンジ背景、オレンジアイコン
Error: 赤背景、赤アイコン
Info: 青背景、青アイコン

高さ: 48px
角丸: 8px
アイコン: 左側、20px
```

---

### 3.5 レスポンシブデザイン

#### ブレークポイント

```css
/* モバイル */
@media (max-width: 640px) { ... }

/* タブレット */
@media (min-width: 641px) and (max-width: 1024px) { ... }

/* デスクトップ */
@media (min-width: 1025px) { ... }
```

#### レイアウト

**デスクトップ（1025px以上）**:
- サイドバー: 固定幅 240px
- メインコンテンツ: 残りの幅
- 最大幅: 1440px（中央揃え）

**タブレット（641-1024px）**:
- サイドバー: 折りたたみ可能
- メインコンテンツ: 全幅

**モバイル（640px以下）**:
- サイドバー: ハンバーガーメニュー
- メインコンテンツ: 全幅
- カードを縦積み

---

### 3.6 アクセシビリティ

#### WCAG 2.1 AA準拠

**コントラスト比**:
- 通常テキスト: 4.5:1以上
- 大きなテキスト（18px以上）: 3:1以上
- UI要素: 3:1以上

**キーボード操作**:
- Tabキーで全要素にアクセス可能
- Enterキーでボタン・リンク実行
- Escキーでモーダル閉じる

**スクリーンリーダー対応**:
- 適切なARIAラベル
- alt属性を全画像に設定
- フォーム要素にlabel関連付け

**フォーカスインジケーター**:
```css
:focus {
  outline: 2px solid #3B82F6;
  outline-offset: 2px;
}
```

---

### 3.7 オンボーディング

#### 初回ユーザー体験

**目標**: 15分以内に初回ルール公開

**ステップ**:

1. **ウェルカム（30秒）**
   - サービス概要を3スライドで説明
   - 「始める」ボタン

2. **サイト登録（2分）**
   - ドメイン入力
   - サイト名入力
   - 「次へ」

3. **トラッキング設置（5分）**
   - SDKコードを表示
   - コピーボタン
   - 設置手順を表示（動画付き）
   - 「設置完了、確認」ボタン
   - バックグラウンドで検証

4. **初回ルール作成（5分）**
   - テンプレート選択（3つ提示）
   - ガイド付きエディタ
   - プレビュー
   - 「公開」

5. **完了（1分）**
   - 次のステップ案内
   - チュートリアル動画リンク
   - サポートへの連絡方法

**プログレスバー**:
各ステップでプログレスバーを表示し、進捗を可視化

**スキップ可能**:
「後で設定」ボタンを各ステップに配置

---

### 3.8 エラーハンドリング

#### エラーメッセージ

**原則**:
- 何が起きたか明確に説明
- なぜ起きたか理由を説明
- どうすれば解決できるか提示

**例**:

❌ 悪い例:
```
エラーが発生しました。
```

✅ 良い例:
```
トラッキングコードが見つかりませんでした。

サイトに正しくSDKコードが設置されているか確認してください。
設置方法を確認する場合は、こちらのガイドをご覧ください。

[ガイドを見る] [サポートに連絡]
```

#### エラー種別

**バリデーションエラー**:
- 入力フィールドの下に赤文字で表示
- アイコン: ⚠️
- 例: 「メールアドレスの形式が正しくありません」

**システムエラー**:
- ページ上部にバナー表示
- アイコン: ❌
- 例: 「サーバーとの通信に失敗しました。しばらくしてから再度お試しください。」

**警告**:
- ページ上部にバナー表示
- アイコン: ⚠️
- 例: 「この実験を削除すると、過去のデータも失われます。本当によろしいですか？」

**成功**:
- ページ上部にバナー表示（3秒後に自動消去）
- アイコン: ✅
- 例: 「ルールを公開しました」

---

### 3.9 パフォーマンス

#### ローディング

**スケルトンスクリーン**:
- データ読み込み中はスケルトンを表示
- スピナーは最小限に

**プログレッシブレンダリング**:
- 重要なコンテンツから順に表示
- 画像は遅延読み込み

**目標**:
- 初回ペイント: 1秒以内
- インタラクティブまで: 3秒以内

---

## まとめ

### UI/UX設計の決定事項

#### 画面構成
- **合計35画面**
- 認証前4画面、ダッシュボード2画面、機能別23画面、設定5画面、オンボーディング5画面

#### ユーザーフロー
- **新規登録〜初回ルール作成**: 15分以内
- **A/Bテスト作成**: 10分以内
- **パーソナライゼーションルール作成**: 8分以内

#### デザインシステム
- **カラー**: プライマリー青、AIエージェント別カラー
- **タイポグラフィ**: Noto Sans JP、8pxグリッドシステム
- **コンポーネント**: ボタン、カード、入力フィールド、通知バナー

#### レスポンシブ
- **3つのブレークポイント**: モバイル、タブレット、デスクトップ
- **モバイルファースト**: 全画面がモバイル対応

#### アクセシビリティ
- **WCAG 2.1 AA準拠**
- キーボード操作、スクリーンリーダー対応

#### オンボーディング
- **15分で初回ルール公開**
- ガイド付き、スキップ可能

---

次は**4. 日本語特化機能の詳細**（形態素解析、敬語調整、商習慣対応）に進みますか？

